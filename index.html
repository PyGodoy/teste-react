<!doctype html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/png" href="/src/assets/images/logo.png" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Apanat Treinamento</title>
    <!-- Manifest do PWA -->
    <link rel="manifest" href="/manifest.json" />
  </head>
  <body>
    <div id="root"></div>
    
    <script type="module" src="/src/main.tsx"></script>

    <!-- Adicionando o código JavaScript do PWA -->
    <script>
      let deferredPrompt;

      // Detecta o evento antes de instalar
      window.addEventListener('beforeinstallprompt', (e) => {
        e.preventDefault();
        deferredPrompt = e;

        // Exibe o banner de "Adicionar à Tela Inicial" no Android/Chrome
        const installBanner = document.createElement('div');
        installBanner.id = 'install-banner';
        installBanner.innerHTML = `
          <p>Adicione à tela inicial para acessar o app mais rápido!</p>
          <button id="install-btn">Adicionar</button>
        `;
        document.body.appendChild(installBanner);

        const installButton = document.getElementById('install-btn');
        installButton.addEventListener('click', () => {
          deferredPrompt.prompt();  // Exibe o prompt para o usuário
          deferredPrompt.userChoice.then((choiceResult) => {
            if (choiceResult.outcome === 'accepted') {
              console.log('Usuário adicionou à tela inicial');
            } else {
              console.log('Usuário não adicionou à tela inicial');
            }
            deferredPrompt = null;  // Reseta o evento
            installBanner.style.display = 'none';  // Esconde o banner após a ação
          });
        });

        // Esconde o banner após 5 segundos
        setTimeout(() => {
          installBanner.style.display = 'none';
        }, 5000);  // 5000 milissegundos = 5 segundos

        installBanner.style.display = 'block';  // Exibe o banner no Android/Chrome
      });

      // Detecta se o dispositivo está usando o Safari (iOS)
      const isIOS = /iphone|ipod|ipad/i.test(navigator.userAgent);
      const isSafari = /^((?!chrome|android).)*safari/i.test(navigator.userAgent);

      if (isIOS && isSafari) {
        // Exibe o banner de PWA para o iOS
        const iosBanner = document.createElement('div');
        iosBanner.id = 'ios-install-banner';
        iosBanner.innerHTML = `
          <p>Adicione à tela inicial para acesso rápido!</p>
          <p><strong>Instruções:</strong> Toque no botão de compartilhamento e selecione "Adicionar à Tela de Início".</p>
        `;
        document.body.appendChild(iosBanner);

        // Esconde o banner após 5 segundos
        setTimeout(() => {
          iosBanner.style.display = 'none';
        }, 10000);  // 5000 milissegundos = 5 segundos
      }
    </script>

    <!-- Estilos para o banner -->
    <style>
      #install-banner {
        position: fixed;
        top: 0; /* Coloca o banner no topo */
        left: 0;
        right: 0;
        background-color: #333;
        color: #fff;
        padding: 10px;
        text-align: center;
        z-index: 1000;
      }

      #install-btn {
        margin-top: 10px;
        padding: 8px 16px;
        background-color: #2268ff;
        color: white;
        border: none;
        border-radius: 5px;
        cursor: pointer;
      }

      #install-btn:hover {
        background-color: #002fff;
      }

      #ios-install-banner {
        position: fixed;
        top: 0; /* Coloca o banner no topo */
        left: 0;
        right: 0;
        background-color: #000;
        color: #fff;
        padding: 15px;
        text-align: center;
        z-index: 1000;
      }
    </style>
  </body>
</html>
